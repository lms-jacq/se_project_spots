!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"};function t(e,t,o){e.some((e=>!e.validity.valid))?(t.classList.add(o.inactiveButtonClass),t.disabled=!0):(t.classList.remove(o.inactiveButtonClass),t.disabled=!1)}const o=document.querySelector(".profile__edit-button"),n=document.querySelector(".profile__add-button"),r=document.querySelector(".profile__name"),a=document.querySelector(".profile__description"),s=document.querySelectorAll(".modal"),c=document.querySelector("#edit-modal"),l=c.querySelector("#edit-profile"),i=c.querySelector(".modal__close-button"),d=c.querySelector("#profile-name-input"),u=c.querySelector("#profile-description-input"),m=document.querySelector("#add-card-modal"),p=m.querySelector("#add-card-form"),_=m.querySelector(".modal__submit-button"),f=m.querySelector(".modal__close-button"),y=m.querySelector("#add-card-link-input"),v=m.querySelector("#add-card-name-input"),S=document.querySelector("#preview-modal"),q=S.querySelector(".modal__image"),b=S.querySelector(".modal__caption"),g=S.querySelector(".modal__close-button"),h=(S.querySelector(".modal__error"),document.querySelector("#card-template")),w=document.querySelector(".cards__list");function k(e){const t=h.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),n=t.querySelector(".card__image"),r=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return o.textContent=e.name,n.src=e.link,n.alt=e.name,r.addEventListener("click",(()=>{r.classList.toggle("card__like-button_liked")})),a.addEventListener("click",(()=>{t.remove()})),n.addEventListener("click",(()=>{L(S),b.textContent=e.name,q.src=e.link,q.alt=e.name})),t}function L(e){e.classList.add("modal_opened"),document.addEventListener("keydown",C)}function E(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",C)}function C(e){"Escape"===e.key&&E(document.querySelector(".modal_opened"))}function x(e){e.target.classList.contains("modal")&&E(e.target)}var z;s.forEach((e=>{e.addEventListener("mousedown",x)})),o.addEventListener("click",(()=>{d.value=r.textContent,u.value=a.textContent,resetValidation(l,[d,u],e),L(c)})),i.addEventListener("click",(()=>{E(c)})),n.addEventListener("click",(()=>{L(m)})),f.addEventListener("click",(()=>{E(m)})),g.addEventListener("click",(()=>{E(S)})),l.addEventListener("submit",(function(e){e.preventDefault(),r.textContent=d.value,a.textContent=u.value,E(c)})),p.addEventListener("submit",(function(t){t.preventDefault();const o=k({name:v.value,link:y.value});w.prepend(o),t.target.reset(),disabledButton(_,e),E(m)})),[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Golden Gate bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}].forEach((e=>{const t=k(e);w.append(t)})),z=e,document.querySelectorAll(z.formSelector).forEach((e=>{!function(e,o){const n=[...e.querySelectorAll(o.inputSelector)],r=e.querySelector(o.submitButtonSelector);t(n,r,o),n.forEach((a=>{a.addEventListener("input",(function(){!function(e,t,o){t.validity.valid?function(e,t,o){let{inputErrorClass:n,errorClass:r}=o;const a=e.querySelector(`#${t.id}-error`);t.classList.remove(n),a.classList.remove(r),a.textContent=""}(e,t,o):function(e,t,o,n){let{inputErrorClass:r,errorClass:a}=n;const s=e.querySelector(`#${t.id}-error`);t.classList.add(r),s.textContent=o,s.classList.add(a)}(e,t,t.validationMessage,o)}(e,a,o),t(n,r,o)}))}))}(e,z)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcbn07XG5cbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNob3dJbnB1dEVycm9yKFxuICBmb3JtRWxlbWVudCxcbiAgaW5wdXRFbGVtZW50LFxuICBlcnJvck1zZyxcbiAgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfVxuKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNc2c7XG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xufVxuXG5mdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihcbiAgZm9ybUVsZW1lbnQsXG4gIGlucHV0RWxlbWVudCxcbiAgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfVxuKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG59XG5cbmZ1bmN0aW9uIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpIHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dChpbnB1dEVsZW1lbnQpIHtcbiAgcmV0dXJuIGlucHV0RWxlbWVudC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gZGlzYWJsZWRCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKSB7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBlbmFibGVCdXR0b24oaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSkge1xuICBpZiAoIWhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKSB7XG4gIC8vIGNvbnN0IHsgaW5wdXRTZWxlY3Rvciwgc3VibWl0QnV0dG9uU2VsZWN0b3IgfSA9IGNvbmZpZztcbiAgY29uc3QgaW5wdXRMaXN0ID0gWy4uLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihjb25maWcpIHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn1cblxuLy8gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cbi8qXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKFxuICAgICAgZm9ybUVsZW1lbnQsXG4gICAgICBpbnB1dEVsZW1lbnQsXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXG4gICAgICBjb25maWdcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gIH1cbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50KTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG4vLyB1c2UgdGhlIHNldHRpbmdzIG9iamVjdCBpbiBhbGwgZnVuY3Rpb25zIGluc3RlYWQgb2YgaGFyZC1jb2RlZCBzdHJpbmdzXG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3Rvcik7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaDtcbiAgKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XG4gIH07XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiovXG4iLCJpbXBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBzZXR0aW5ncyB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy8gaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xuXG4vLyBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFyXCIpO1xuLy8gYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGFyU3JjO1xuXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIGJyaWRnZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbl07XG5cbi8vIHByb2ZpbGUgZWxlbWVudHNcblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZE1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuXG4vLyBlZGl0IHByb2ZpbGUgZWxlbWVudHNcblxuY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZVwiKTtcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnV0dG9uID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG4vLyBhZGQgY2FyZHMgZWxlbWVudHNcblxuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcbmNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IGNhcmRNb2RhbENsb3NlQnV0dG9uID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XG5cbi8vIHByZXZpZXcgbW9kYWwgZWxlbWVudHNcblxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1hZ2VFbGVtZW50ID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbkVsZW1lbnQgPVxuICBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnV0dG9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuKTtcbmNvbnN0IHByZXZpZXdNb2RhbEVycm9yTXNnID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Vycm9yXCIpO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG5cbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICBjYXJkTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XG4gIH0pO1xuXG4gIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgfSk7XG5cbiAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XG5cbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XG4gIH0pO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsRXNjKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsRXNjKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbEVzYyhldmVudCkge1xuICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3QgbW9kYWxPcGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgY2xvc2VNb2RhbChtb2RhbE9wZW4pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsb3NlT3ZlcmxheShldmVudCkge1xuICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChldmVudC50YXJnZXQpO1xuICB9XG59XG5cbm1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlT3ZlcmxheSk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG5cbiAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7IG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUsIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUgfTtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpbnB1dFZhbHVlcyk7XG5cbiAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICBldmVudC50YXJnZXQucmVzZXQoKTtcblxuICBkaXNhYmxlZEJ1dHRvbihjYXJkU3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG5cbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xufVxuXG4vLyBmdW5jdGlvbiBjaGVja0Zvcm1WYWxpZGl0eSgpIHtcbi8vICAgaWYgKG1vZGFsRm9ybS5jaGVja1ZhbGlkaXR5KCkpIHtcbi8vICAgICBjYXJkU3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiKTtcbi8vICAgICBjYXJkU3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4vLyAgIH0gZWxzZSB7XG4vLyAgICAgY2FyZFN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIik7XG4vLyAgICAgY2FyZFN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4vLyAgIH1cbi8vIH1cblxuLy8gbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuLy8gICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgY2hlY2tGb3JtVmFsaWRpdHkpO1xuLy8gfSk7XG5cbi8vIGNoZWNrRm9ybVZhbGlkaXR5KCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgZWRpdEZvcm1FbGVtZW50LFxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxuICAgIHNldHRpbmdzXG4gICk7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xufSk7XG5cbmVkaXRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbn0pO1xuXG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGNhcmRNb2RhbCk7XG59KTtcblxuY2FyZE1vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xufSk7XG5cbnByZXZpZXdNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbn0pO1xuXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuXG5pbml0aWFsQ2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiJdLCJuYW1lcyI6WyJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiY29uZmlnIiwic29tZSIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJkaXNhYmxlZCIsInJlbW92ZSIsInByb2ZpbGVFZGl0QnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2FyZE1vZGFsQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJtb2RhbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWRpdE1vZGFsIiwiZWRpdEZvcm1FbGVtZW50IiwiZWRpdE1vZGFsQ2xvc2VCdXR0b24iLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwiY2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkU3VibWl0QnV0dG9uIiwiY2FyZE1vZGFsQ2xvc2VCdXR0b24iLCJjYXJkTGlua0lucHV0IiwiY2FyZE5hbWVJbnB1dCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltYWdlRWxlbWVudCIsInByZXZpZXdNb2RhbENhcHRpb25FbGVtZW50IiwicHJldmlld01vZGFsQ2xvc2VCdXR0b24iLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsZW1lbnQiLCJjYXJkSW1hZ2UiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmREZWxldGVCdXR0b24iLCJ0ZXh0Q29udGVudCIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiY2xvc2VNb2RhbEVzYyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJjbG9zZU92ZXJsYXkiLCJ0YXJnZXQiLCJjb250YWlucyIsImZvckVhY2giLCJ2YWx1ZSIsInJlc2V0VmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicHJlcGVuZCIsInJlc2V0IiwiZGlzYWJsZWRCdXR0b24iLCJpdGVtIiwiYXBwZW5kIiwiZm9ybUVsZW1lbnQiLCJfcmVmMiIsImVycm9yRWxlbWVudCIsImlkIiwiaGlkZUlucHV0RXJyb3IiLCJlcnJvck1zZyIsIl9yZWYiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9